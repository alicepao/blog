---
title: "Logistic & Multiple Linear Regression Model for Praxis Scores"
author: "Alice Pao"
date: "2024-03-06"
categories: [portfolio, r]
image: "logistic regression.png"
---

This post is to showcase my statistical analyses for praxis scores collected from students majoring in teacher education at an Idaho higher education institution. This project is part of [Benjamin Pacini's dissertation](https://sites.google.com/view/benjamin-pacini/dissertation/methodology). 

The two research questions we are trying to answer are: 
1. What predicts strong teaching? 
2. How do measures of success correlate with each other? 

In this blog, I'll focus on running statistical analyses to answer the first question. I run logistic and multiple linear regression models using the praxis data set I got. (for its data cleaning and transformation process, please refer to my [other blog post]())

## What Predicts Strong Teaching? 

For the following regression models, the target(y) will be different results for praxis scores and the features(x) will be different student demographics. 

#### Kitchen Sink Model: Ever Pass

```{r, warning = FALSE, message = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"
library(tidyverse)
library(arrow)
library(ResourceSelection)
library(ggpubr)
library(pander)

praxis <- read.csv("/Users/alice/Library/Mobile Documents/com~apple~CloudDocs/Portfolio/Data Science Blog/blog/posts/regression_model/final_praxis.csv", header = TRUE, stringsAsFactors = TRUE)
demo <- read_parquet("/Users/alice/Library/Mobile Documents/com~apple~CloudDocs/Portfolio/Data Science Blog/blog/posts/regression_model/All_teacher_info.parquet")

demo <- demo %>%  mutate(Ethnicity = case_when(Ethnicity == "White" ~ "White", 
                               TRUE ~ "Not White"))


praxis_ever_pass <- praxis %>% 
  select(student_id, ever_pass) %>% 
  mutate(student_id = as.character(student_id))

praxis_ever_pass <- inner_join(praxis_ever_pass, demo, by = c("student_id" = "StudentID"))
praxis_ever_pass <- praxis_ever_pass %>% relocate(ever_pass, .before = "student_id") %>% unique()

# all_ever_pass <- glm(ever_pass ~ ServedMission*Ethnicity*isMale*CurrentCumGPA*ACTSAT_Scores*
#                     HighSchoolGPA*ReceivedPell*FirstSemAge*FirstSemMaritalStatus*
#                       asMajor*firstSemGPAinTeaching*finalMinor*gradType, data = praxis_ever_pass, family = binomial)
# summary(all_ever_pass)

demo_ever_pass <- glm(ever_pass ~ ServedMission*Ethnicity*isMale*ReceivedPell*FirstSemAge*FirstSemMaritalStatus, data = praxis_ever_pass, family = binomial)

pre_ever_pass <- glm(ever_pass ~ ACTSAT_Scores*HighSchoolGPA, data = praxis_ever_pass, family = binomial)

```


```{r, warning = FALSE, message = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

summary(demo_ever_pass)%>% pander()
summary(pre_ever_pass)%>% pander()

```

#### Kitchen Sink Model: First ZScore

```{r, warning = FALSE, message = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"
praxis_first_zscore <- praxis %>% 
  select(student_id, first_z_score) %>% 
  mutate(student_id = as.character(student_id))

praxis_first_zscore <- inner_join(praxis_first_zscore, demo, by = c("student_id" = "StudentID")) %>% 
  relocate(first_z_score, .before = "student_id") %>% unique()

# all_praxis_first_zscore <- lm(first_z_score ~ ServedMission*Ethnicity*isMale*CurrentCumGPA*ACTSAT_Scores*
#                                 HighSchoolGPA*ReceivedPell*FirstSemAge*FirstSemMaritalStatus*
#                                 asMajor*firstSemGPAinTeaching*finalMinor*gradType, data = praxis_first_zscore)

# summary(all_praxis_first_zscore)

demo_praxis_first_zscore <- lm(first_z_score ~ ServedMission*Ethnicity*isMale*ReceivedPell*FirstSemAge*FirstSemMaritalStatus, data = praxis_first_zscore)
summary(demo_praxis_first_zscore)%>% pander()

pre_praxis_first_zscore <- lm(first_z_score ~ ACTSAT_Scores*HighSchoolGPA, data = praxis_first_zscore)
summary(pre_praxis_first_zscore)%>% pander()

```

#### Kitchen Sink Model: Last ZScore

```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

praxis_last_zscore <- praxis %>% 
  select(student_id, last_z_score) %>% 
  mutate(student_id = as.character(student_id))

praxis_last_zscore <- inner_join(praxis_last_zscore, demo, by = c("student_id" = "StudentID")) %>% 
  relocate(last_z_score, .before = "student_id") %>% unique()

# all_praxis_last_zscore <- lm(last_z_score ~ ServedMission*Ethnicity*isMale*CurrentCumGPA*ACTSAT_Scores*
#                                 HighSchoolGPA*ReceivedPell*FirstSemAge*FirstSemMaritalStatus*
#                                 asMajor*firstSemGPAinTeaching*finalMinor*gradType, data = praxis_last_zscore)

# summary(all_praxis_last_zscore)

demo_praxis_last_zscore <- lm(last_z_score ~ ServedMission*Ethnicity*isMale*ReceivedPell*FirstSemAge*FirstSemMaritalStatus, data = praxis_last_zscore)
summary(demo_praxis_last_zscore)%>% pander()

pre_praxis_last_zscore <- lm(last_z_score ~ ACTSAT_Scores*HighSchoolGPA, data = praxis_last_zscore)
summary(pre_praxis_last_zscore)%>% pander()
 
```

#### Ktichen Sink Model: Last Cutoff

```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"
praxis_last_cutoff <- praxis %>% 
  select(student_id, last_score_cutoff) %>% 
  mutate(student_id = as.character(student_id))

praxis_last_cutoff <- inner_join(praxis_last_cutoff, demo, by = c("student_id" = "StudentID")) %>% 
  relocate(last_score_cutoff, .before = "student_id") %>% unique()

# all_last_cutoff <- lm(last_score_cutoff ~ ServedMission*Ethnicity*isMale*CurrentCumGPA*ACTSAT_Scores*
#                                 HighSchoolGPA*ReceivedPell*FirstSemAge*FirstSemMaritalStatus*
#                                 asMajor*firstSemGPAinTeaching*finalMinor*gradType, data = praxis_last_cutoff)
# summary(all_last_cutoff)

demo_praxis_last_cutoff <- lm(last_score_cutoff ~ ServedMission*Ethnicity*isMale*ReceivedPell*FirstSemAge*FirstSemMaritalStatus, data = praxis_last_cutoff)
summary(demo_praxis_last_zscore)%>% pander()

pre_praxis_last_cutoff <- lm(last_score_cutoff~ ACTSAT_Scores*HighSchoolGPA, data = praxis_last_cutoff)
summary(pre_praxis_last_cutoff)%>% pander()

```


* Regression 1: Target is if a student ever pass praxis test. 0 means fail and 1 means pass. 

In total, we have 4695 student subjects. 401 students never passed their praxis tests while 4228 students eventually passed praxis. We have 66 students didn't indicate whether they passed praxis or not. In all the models I ran, these NAs were omitted. 

### Does `*current cumulative college GPA*` predict if a student eventually passes praxis test or not? 
For this model, I set *alpha* to be 0.05; the following is the result of the model. We see that the p-value for Current Cumulative GPA variable is smaller than 0.05. Therefore, we can make an inference that current cumulative GPA is somewhat useful when it comes to predicting if a student can pass praxis test or not. However, since the AIC score for this model is 2628, it means that this model isn't the most accurate.


```{r, message = FALSE, warning=FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

# 1: Logistic Regression Model 
# Logistic Regression Model: Ever Pass vs CurrentCumGPA
glm_ever_pass_gpa <- glm(ever_pass ~ CurrentCumGPA, data = praxis_ever_pass, family = binomial)
summary(glm_ever_pass_gpa) %>% pander()
ggplot(data = praxis_ever_pass, aes(x=CurrentCumGPA, y = ever_pass))+
  geom_jitter(alpha = 0.2, width = 0.5, height = 0.1)+
  stat_smooth(method='glm', method.args = list(family = "binomial"),
              formula = y ~ x) + 
  theme_bw()+
  labs(title = "Current Cumulative GPA vs Final Praxis Pass", 
       subtitle = "0 means the student never pass, 1 means the student passes", 
       y = "Ever Pass or not", x = "Current Cumulative GPA")+
  geom_hline(yintercept =1, linetype = "dashed", color = "red")
```

### Does *current cumulative college GPA by ethnicity* predict if a student eventually passes praxis test or not? 
For this model, I added ethnicity to be another feature becuase I am curious if ethnicity can contribute to the prediction. The original data has 9 different ethinicity groups; however, for the sake of simplicity, some of them are grouped together. 

Here are the final ethnicity groups: 
* American Indian/Alaskan & Hawaiian, Pacific Islander
* Black
* Hispanic
* Two or more ethnicities
* Other & unknown
* White

From the table below, none of the variables p-value are smaller than 0.05. The AIC score is 2631.8 which is too high (the lower the AIC score, the more fitted a model is)
```{r, message = FALSE, warning=FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"
# Logistic Regression Model: Ever Pass vs CurrentCumGPA & Ethnicity
ever_pass_ethnicity <- praxis_ever_pass %>% 
                        mutate(Ethnicity = case_when(Ethnicity == "American Indian/Alaskan" | Ethnicity == "Hawaiian, Pacific Island" ~ "American Indian/Alaskan & Hawaiian, Pacific Islander", 
                                                     Ethnicity == "Black" ~ "Black", 
                                                     Ethnicity == "Hispanic, Latino" ~ "Hispanic", 
                                                     Ethnicity == "Two or More Ethnicities" ~ "Two or More Ethnicities", 
                                                     Ethnicity == "Asian" ~ "Asian", 
                                                     Ethnicity == "Other" | Ethnicity == "Unknown" ~ "Other & Unknown", 
                                                     Ethnicity == "White" ~ "White", 
                                                     TRUE ~ "BLANK"))
glm_ever_pass_ethnicity <- glm(ever_pass ~ CurrentCumGPA*Ethnicity, data = ever_pass_ethnicity, family = binomial)
summary(glm_ever_pass_ethnicity)
ggplot(data = ever_pass_ethnicity, aes(x=CurrentCumGPA, y = ever_pass))+
  geom_jitter(alpha = 0.2, width = 0.5, height = 0.1)+
  stat_smooth(method='glm', method.args = list(family = "binomial"),
              formula = y ~ x, aes(color = Ethnicity)) + 
  theme_bw()+
  labs(title = "Current Cumulative GPA vs Final Praxis Pass by Student's Ethnicity", 
                   subtitle = "0 means the student never pass, 1 means the student passes", 
                   y = "Ever Pass or not", x = "Current Cumulative GPA" )+
   geom_hline(yintercept =1, linetype = "dashed", color = "red")
```

### Does *current cumulative college GPA by gender* predict if a student eventually passes praxis test or not? 

This model analyzes if the cumulative college gpa and gender can predict passing praxis test. From the graph, there isn't any strong indication that gender contribute to this prediction. 

```{r, message = FALSE, warning=FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

library(Hmisc)
praxis_ever_pass%>%select(CurrentCumGPA, isMale, ever_pass)%>%describe()
```


Here's a table showing the model's result: 


```{r, message = FALSE, warning=FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"
# Logistic Regression Model: Ever Pass vs CurrentCumGPA & isMale
glm_ever_pass_male <- glm(ever_pass ~ CurrentCumGPA*isMale, data = praxis_ever_pass, family = binomial)
summary(glm_ever_pass_male) %>% pander()
ggplot(data = praxis_ever_pass, aes(x=CurrentCumGPA, y = ever_pass))+
  geom_jitter(alpha = 0.2, width = 0.5, height = 0.1)+
  stat_smooth(method='glm', method.args = list(family = "binomial"),
              formula = y ~ x, aes(color = as.factor(isMale))) + 
  theme_bw()+
  labs(title = "Current Cumulative GPA vs Final Praxis Pass by Gender", 
       subtitle = "0 means the student never pass, 1 means the student passes", 
       y = "Ever Pass or not", x = "Current Cumulative GPA", color = "Gender")+
  scale_color_discrete(breaks=c("0", "1"),
                      labels=c("Female", "Male"))+
  geom_hline(yintercept =1, linetype = "dashed", color = "red")
```

### Does *current cumulative college GPA with pell grant* predict if a student eventually passes praxis test or not? 

```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"
# Logistic Regression Model: Ever Pass vs CurrentCumGPA & ReceivedPell
ggplot(data = praxis_ever_pass, aes(x=CurrentCumGPA, y = ever_pass))+
  geom_jitter(alpha = 0.2, width = 0.5, height = 0.1)+
  stat_smooth(method='glm', method.args = list(family = "binomial"),
              formula = y ~ x, aes(color = as.factor(ReceivedPell))) + 
  theme_bw()+
  labs(title = "Current Cumulative GPA vs Final Praxis Pass for Pell Grant Receipients", 
       subtitle = "0 means the student never pass, 1 means the student passes", 
       y = "Ever Pass or not", x = "Current Cumulative GPA", color = "Pell Grant Receiver or not")+
  scale_color_discrete(breaks= c("0", "1"), 
                       labels = c("No", "Yes"))+
  geom_hline(yintercept = 1, linetype = "dashed", color = "red")
```


### Does *current cumulative college GPA with mission* predict if a student eventually passes praxis test or not? 


```{r, message = FALSE, warning=FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

praxis_ever_pass%>%select(CurrentCumGPA, ServedMission, ever_pass)%>%describe()
```


```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"
# Logistic Regression Model: Ever Pass vs CurrentCumGPA & ServedMission

ggplot(data = praxis_ever_pass, aes(x=CurrentCumGPA, y = ever_pass))+
  geom_jitter(alpha = 0.2, width = 0.5, height = 0.1)+
  stat_smooth(method='glm', method.args = list(family = "binomial"),
              formula = y ~ x, aes(color = as.factor(ServedMission))) + 
  theme_bw()+
  labs(title = "Current Cumulative GPA vs Final Praxis Pass by Gender", 
       subtitle = "0 means the student never pass, 1 means the student passes", 
       y = "Ever Pass or not", x = "Current Cumulative GPA", color = "Mission")+
  scale_color_discrete(breaks=c("FALSE", "TRUE"),
                       labels=c("Non-returned Missionary", "Returned Missionary"))+
  geom_hline(yintercept =1, linetype = "dashed", color = "red")
```

### Does *self-reported ACT & SAT score* predict if a student eventually passes praxis test or not? 


```{r, message = FALSE, warning=FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"
# Logistic Regression Model: Ever Pass vs ACTSAT_Scores
glm_ever_pass_ACTSAT <- glm(ever_pass ~ ACTSAT_Scores, data = praxis_ever_pass, family = binomial)
summary(glm_ever_pass_ACTSAT)%>% pander()
ggplot(data = praxis_ever_pass, aes(x=ACTSAT_Scores, y = ever_pass))+
  geom_jitter(alpha = 0.2, width = 0.5, height = 0.1)+
  geom_smooth(method = "glm", method.args=list(family=binomial), se=FALSE)+
  theme_bw()+
  labs(title = "Self-Reported ACT and SAT Score vs Final Praxis Pass", 
       subtitle = "0 means the student never passes, 1 means the student passes", 
       y = "Ever Pass or not", x = "ACT or SAT Score")
```

### Does *self-reported ACT & SAT score by Ethnicity* predict if a student eventually passes praxis test or not? 


```{r, message = FALSE, warning=FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"
# Logistic Regression Model: Ever Pass vs ACTSAT_Scores & Ethnicity
glm_ever_pass_ACTSAT_ethnicity <- glm(ever_pass ~ ACTSAT_Scores*Ethnicity, data = praxis_ever_pass, family = binomial)
ggplot(data = praxis_ever_pass, aes(x=ACTSAT_Scores, y = ever_pass))+
  geom_jitter(alpha = 0.2, width = 0.5, height = 0.1)+
  geom_smooth(method = "glm", method.args=list(family=binomial), se=FALSE, aes(color = Ethnicity))+
  theme_bw()+
  labs(title = "Self-Reported ACT and SAT Score vs Final Praxis Pass by Ethnicity", 
       subtitle = "0 means the student never passes, 1 means the student passes", 
       y = "Ever Pass or not", x = "ACT or SAT Score", color = "Ethnicity")
```

### Does *self-reported ACT & SAT score by gender* predict if a student eventually passes praxis test or not? 

```{r, message = FALSE, warning=FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"


# Logistic Regression Model: Ever Pass vs ACTSAT_Scores & isMale
glm_ever_pass_ACTSAT_male <- glm(ever_pass ~ ACTSAT_Scores*isMale, data = praxis_ever_pass, family = binomial)
ggplot(data = praxis_ever_pass, aes(x=ACTSAT_Scores, y = ever_pass))+
  geom_jitter(alpha = 0.2, width = 0.5, height = 0.1)+
  geom_smooth(method = "glm", method.args=list(family=binomial), se=FALSE, aes(color = as.factor(isMale)))+
  theme_bw()+
  labs(title = "Self-Reported ACT and SAT Score vs Final Praxis Pass by Gender", 
       subtitle = "0 means the student never passes, 1 means the student passes", 
       y = "Ever Pass or not", x = "ACT or SAT Score", color = "Gender")+
  scale_color_discrete(breaks= c("0", "1"), 
                       labels = c("Female", "Male"))
```


### Does *self-reported ACT & SAT score with mission* predict if a student eventually passes praxis test or not? 

```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"
# Logistic Regression Model: Ever Pass vs ACTSAT_Scores & ServedMission

ggplot(data = praxis_ever_pass, aes(x=ACTSAT_Scores, y = ever_pass))+
  geom_jitter(alpha = 0.2, width = 0.5, height = 0.1)+
  stat_smooth(method='glm', method.args = list(family = "binomial"),
              formula = y ~ x, aes(color = as.factor(ServedMission))) + 
  theme_bw()+
  labs(title = "Self-Reported ACT and SAT Score vs Final Praxis Pass With Students Serving or Not Serving Mission", 
       subtitle = "0 means the student never pass, 1 means the student passes", 
       y = "Ever Pass or not", x = "ACT or SAT Score", color = "Mission")+
  scale_color_discrete(breaks= c("FALSE", "TRUE"), 
                       labels = c("Non-returned Missionary", "Returned Missionary"))+
  geom_hline(yintercept = 1, linetype = "dashed", color = "red")


```


### Does *self-reported ACT & SAT score with pell grant* predict if a student eventually passes praxis test or not? 

```{r, message = FALSE, warning=FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"


# Logistic Regression Model: Ever Pass vs CurrentCumGPA & ReceivedPell
glm_ever_pass_pell <- glm(ever_pass ~ CurrentCumGPA*ReceivedPell, data = praxis_ever_pass, family = binomial)
ggplot(data = praxis_ever_pass, aes(x=CurrentCumGPA, y = ever_pass))+
  geom_jitter(alpha = 0.2, width = 0.5, height = 0.1)+
  geom_smooth(method = "glm", method.args=list(family=binomial), se=FALSE, aes(color = as.factor(ReceivedPell)))+
  theme_bw()+
  labs(title = "Current Cumulative GPA vs Final Praxis Pass for Pell Grant Receivers", 
       subtitle = "0 means the student never passes, 1 means the student passes", 
       y = "Ever Pass or not", x = "Current Cumulative GPA", color = "Pell Grant Receiver or not")+
  scale_color_discrete(breaks= c("0", "1"), 
                       labels = c("No", "Yes"))
```

### Does *self-reported high school GPA* predict if a student eventually passes praxis test or not? 

```{r, message = FALSE, warning=FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"
# Logistic Regression Model: Ever Pass vs HighSchoolGPA 
ggplot(data = praxis_ever_pass, aes(x=HighSchoolGPA, y = ever_pass))+
  geom_jitter(alpha = 0.2, width = 0.5, height = 0.1)+
  stat_smooth(method='glm', method.args = list(family = "binomial"),
              formula = y ~ x) + 
  theme_bw()+
  labs(title = "Self-Reported High School GPA vs Final Praxis Pass", 
       subtitle = "0 means the student never pass, 1 means the student passes", 
       y = "Ever Pass or not", x = "High School GPA")+
  geom_hline(yintercept = 1, linetype = "dashed", color = "red")
```

### Does *self-reported high school GPA by ethnicity* predict if a student eventually passes praxis test or not? 

```{r, message = FALSE, warning=FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"
# Logistic Regression Model: Ever Pass vs HighSchoolGPA 
ggplot(data = praxis_ever_pass, aes(x=HighSchoolGPA, y = ever_pass))+
  geom_jitter(alpha = 0.2, width = 0.5, height = 0.1)+
  stat_smooth(method='glm', method.args = list(family = "binomial"),
              formula = y ~ x, aes(color = as.factor(Ethnicity))) + 
  theme_bw()+
  labs(title = "Self-Reported ACT and SAT Score vs Final Praxis Pass for Pell Grant Receipients", 
       subtitle = "0 means the student never pass, 1 means the student passes", 
       y = "Ever Pass or not", x = "High School GPA", color = "Pell Grant Receiver or not")+
  scale_color_discrete(breaks= c("0", "1"), 
                       labels = c("No", "Yes"))+
  geom_hline(yintercept = 1, linetype = "dashed", color = "red")
```

### Does *self-reported high school GPA by gender* predict if a student eventually passes praxis test or not? 

```{r, message = FALSE, warning=FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"
# Logistic Regression Model: Ever Pass vs HighSchoolGPA & isMale
ggplot(data = praxis_ever_pass, aes(x=HighSchoolGPA, y = ever_pass))+
  geom_jitter(alpha = 0.2, width = 0.5, height = 0.1)+
  stat_smooth(method='glm', method.args = list(family = "binomial"),
              formula = y ~ x, aes(color = as.factor(isMale))) + 
  theme_bw()+
  labs(title = "Self-Reported High School GPA vs Final Praxis Pass by Gender", 
       subtitle = "0 means the student never pass, 1 means the student passes", 
       y = "Ever Pass or not", x = "High School GPA", color = "Gender")+
  scale_color_discrete(breaks=c("0", "1"),
                       labels=c("Female", "Male"))+
  geom_hline(yintercept =1, linetype = "dashed", color = "red")

```

### Does *self-reported high school GPA with mission* predict if a student eventually passes praxis test or not? 

```{r, message = FALSE, warning=FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"


# Logistic Regression Model: Ever Pass vs HighSchoolGPA & ServedMission
ggplot(data = praxis_ever_pass, aes(x=HighSchoolGPA, y = ever_pass))+
  geom_jitter(alpha = 0.2, width = 0.5, height = 0.1)+
  stat_smooth(method='glm', method.args = list(family = "binomial"),
              formula = y ~ x, aes(color = as.factor(ServedMission))) + 
  theme_bw()+
  labs(title = "Self-Reported High School GPA vs Final Praxis Pass with Returned Missionary", 
       subtitle = "0 means the student never pass, 1 means the student passes", 
       y = "Ever Pass or not", x = "High School GPA", color = "Mission")+
  scale_color_discrete(breaks=c("FALSE", "TRUE"),
                       labels=c("Non-returned Missionary", "Returned Missionary"))+
  geom_hline(yintercept =1, linetype = "dashed", color = "red")

```


* Regression 2: Target is a student's first attempt praxis z score

### Does *current cumulative college GPA* predict a student's first attempt praxis performance or not? 

```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"
praxis_first_zscore <- praxis %>% 
  select(student_id, first_z_score) %>% 
  mutate(student_id = as.character(student_id))

praxis_first_zscore <- inner_join(praxis_first_zscore, demo, by = c("student_id" = "StudentID")) %>% 
  relocate(first_z_score, .before = "student_id") %>% unique()

```

### Does *current cumulative college GPA by Ethnicity* predict a student's first attempt praxis performance or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

```

### Does *current cumulative college GPA by gender* predict a student's first attempt praxis performance or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"
# First Praxis Z Score vs CurrentCumGPA & isMale
fpz_ccgpa_gender <- lm(first_z_score ~ CurrentCumGPA + as.factor(isMale) + CurrentCumGPA:as.factor(isMale), data = praxis_first_zscore)
summary(fpz_ccgpa_gender)
b <- coef(fpz_ccgpa_gender)
ggplot(praxis_first_zscore, aes(y = first_z_score, x = CurrentCumGPA, color = as.factor(isMale)))+
  geom_point(alpha = 0.2)+
  stat_function(fun = function(x) b[1] + b[2]*x, color = "blue")+ #male line
  stat_function(fun = function(x) (b[1]+b[3]) + (b[2]+b[4])*x, color = "red" )+ #female line
  theme_bw()+
  labs(title = "Current Cummulative GPA vs First Praxis Z score By Gender", 
       y = "First Attempt Praxis Z Score", x = "Current Cummulative GPA", color = 'Gender')+
  scale_color_manual(name="Gender", values=c("red","blue"), labels = c('Female', 'Male'))

```

### Does *current cumulative college GPA with pell grant* predict a student's first attempt praxis performance or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

# First Praxis Z Score vs CurrentCumGPA & isMale
fpz_ccgpa_pell <- lm(first_z_score ~ CurrentCumGPA + as.factor(ReceivedPell) + CurrentCumGPA:as.factor(ReceivedPell), data = praxis_first_zscore)
summary(fpz_ccgpa_pell)
b <- coef(fpz_ccgpa_pell)
ggplot(praxis_first_zscore, aes(y = first_z_score, x = CurrentCumGPA, color = as.factor(ReceivedPell)))+
  geom_point(alpha = 0.2)+
  stat_function(fun = function(x) b[1] + b[2]*x, color = "blue")+ #pell line
  stat_function(fun = function(x) (b[1]+b[3]) + (b[2]+b[4])*x, color = "red" )+ #non-pell line
  theme_bw()+
  labs(title = "Current Cummulative GPA vs First Praxis Z score with Pell Grant", 
       y = "First Attempt Praxis Z Score", x = "Current Cummulative GPA", color = 'Pell Grant')+
  scale_color_manual(name="Pell Grant", values=c("red","blue"), labels = c('Non-Pell Grant Receiver', 'Pell Grant Receiver'))


```

### Does *current cumulative college GPA with mission* predict a student's first attempt praxis performance or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

# First Praxis Z Score vs CurrentCumGPA & ServedMission
fpz_ccgpa_mission <- lm(first_z_score ~ CurrentCumGPA + ServedMission + CurrentCumGPA:ServedMission, data = praxis_first_zscore)
summary(fpz_ccgpa_mission)
b <- coef(fpz_ccgpa_mission)
ggplot(praxis_first_zscore, aes(y = first_z_score, x = CurrentCumGPA, color = ServedMission))+
  geom_point(alpha = 0.2)+
  stat_function(fun = function(x) b[1] + b[2]*x, color = "blue")+ #non-return missionary line
  stat_function(fun = function(x) (b[1]+b[3]) + (b[2]+b[4])*x, color = "red" )+ #returned missionary line
  theme_bw()+
  labs(title = "Current Cummulative GPA vs First Praxis Z score with Returned Missionary", 
       y = "First Attempt Praxis Z Score", x = "Current Cummulative GPA", color = 'Mission')+
  scale_color_manual(name="Mission", values=c("red","blue"), labels = c('Returned Missionary', 'Non-Returned Missionary'))

```

### Does *self-reported ACT and SAT score* predict a student's first attempt praxis performance or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

# First Praxis Z Score vs ACTSAT_Score
fpz_act <- lm(first_z_score ~ ACTSAT_Scores, data = praxis_first_zscore)
summary(fpz_act)
ggplot(praxis_first_zscore, aes(y = first_z_score, x = ACTSAT_Scores))+
  geom_point(alpha = 0.2)+
  geom_smooth(method = "lm", formula = y~x, se = FALSE)+
  theme_bw()+
  labs(title = "Self-Reported ACT & SAT Score vs First Praxis Z score", 
       y = "First Attempt Praxis Z Score", x = "ACT & SAT Score")

```

### Does *self-reported ACT and SAT score by enthnicity* predict a student's first attempt praxis performance or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

# First Praxis Z Score vs ACTSAT_Score & Ethnicity

```

### Does *self-reported ACT and SAT score by gender* predict a student's first attempt praxis performance or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

# First Praxis Z Score vs ACTSAT_Score & isMale
fpz_act_gender <- lm(first_z_score ~ ACTSAT_Scores + as.factor(isMale) + ACTSAT_Scores:as.factor(isMale), data = praxis_first_zscore)
summary(fpz_act_gender)
b <- coef(fpz_act_gender)
ggplot(praxis_first_zscore, aes(y = first_z_score, x = ACTSAT_Scores, color = as.factor(isMale)))+
  geom_point(alpha = 0.2)+
  stat_function(fun = function(x) b[1] + b[2]*x, color = "blue")+ #male line
  stat_function(fun = function(x) (b[1]+b[3]) + (b[2]+b[4])*x, color = "red")+ #female line
  theme_bw()+
  labs(title = "Self-Reported ACT & SAT Score vs First Praxis Z score by Gender", 
       y = "First Attempt Praxis Z Score", x = "ACT & SAT Score", color = 'Gender')+
  scale_color_manual(name="Gender", values=c("red","blue"), labels = c('Female', 'Male'))
```

### Does *self-reported ACT and SAT score with pell grant* predict a student's first attempt praxis performance or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

# First Praxis Z Score vs ACTSAT_Score & ReceivedPell
fpz_act_pell <- lm(first_z_score ~ ACTSAT_Scores + as.factor(ReceivedPell) + ACTSAT_Scores:as.factor(ReceivedPell), data = praxis_first_zscore)
summary(fpz_act_pell)
b <- coef(fpz_act_pell)
ggplot(praxis_first_zscore, aes(y = first_z_score, x = ACTSAT_Scores, color = as.factor(ReceivedPell)))+
  geom_point(alpha = 0.2)+
  stat_function(fun = function(x) b[1] + b[2]*x, color = "blue")+ #pell line
  stat_function(fun = function(x) (b[1]+b[3]) + (b[2]+b[4])*x, color = "red")+ #non-pell line
  theme_bw()+
  labs(title = "Self-Reported ACT & SAT Score vs First Praxis Z score with Pell Grant", 
       y = "First Attempt Praxis Z Score", x = "ACT & SAT Score", color = 'Pell Grant')+
  scale_color_manual(name="Pell Grant", values=c("red","blue"), labels = c('Non-Pell Grant Receiver', 'Pell Grant Receiver'))

```


### Does *self-reported ACT and SAT score with mission* predict a student's first attempt praxis performance or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

# First Praxis Z Score vs ACTSAT_Score & ServedMission
fpz_act_mission <- lm(first_z_score ~ ACTSAT_Scores + as.factor(ServedMission) + ACTSAT_Scores:as.factor(ServedMission), data = praxis_first_zscore)
summary(fpz_act_mission)
b <- coef(fpz_act_mission)
ggplot(praxis_first_zscore, aes(y = first_z_score, x = ACTSAT_Scores, color = as.factor(ServedMission)))+
  geom_point(alpha = 0.2)+
  stat_function(fun = function(x) b[1] + b[2]*x, color = "blue")+ #non-returned missionary line
  stat_function(fun = function(x) (b[1]+b[3]) + (b[2]+b[4])*x, color = "red")+ #returned missionary line
  theme_bw()+
  labs(title = "Self-Reported ACT & SAT Score vs First Praxis Z score with Mission", 
       y = "First Attempt Praxis Z Score", x = "ACT & SAT Score", color = 'Mission')+
  scale_color_manual(name="Mission", values=c("red","blue"), labels = c('Rerturned Missionary', 'Non-Returned Missionary'))

```

### Does *self-reported high school GPA* predict a student's first attempt praxis performance or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

# First Praxis Z Score vs HigSchoolGPA
fpz_high <- lm(first_z_score ~ HighSchoolGPA, data = praxis_first_zscore)
summary(fpz_high)
ggplot(praxis_first_zscore, aes(y = first_z_score, x = HighSchoolGPA))+
  geom_point(alpha = 0.2)+
  geom_smooth(method = "lm", formula = y~x, se = FALSE)+
  theme_bw()+
  labs(title = "Self-Reported High School GPA vs First Praxis Z score", 
       y = "First Attempt Praxis Z Score", x = "High School GPA")

```

### Does *self-reported high school GPA by ethnicity* predict a student's first attempt praxis performance or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

# First Praxis Z Score vs HigSchoolGPA & Ethnicity


```

### Does *self-reported high school GPA by gender* predict a student's first attempt praxis performance or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

# First Praxis Z Score vs HighSchoolGPA & isMale
fpz_high_gender <- lm(first_z_score ~ HighSchoolGPA + as.factor(isMale) + HighSchoolGPA:as.factor(isMale), data = praxis_first_zscore)
summary(fpz_high_gender)
b <- coef(fpz_high_gender)
ggplot(praxis_first_zscore, aes(y = first_z_score, x = HighSchoolGPA, color = as.factor(isMale)))+
  geom_point(alpha = 0.2)+
  stat_function(fun = function(x) b[1] + b[2]*x, color = "blue")+ #male line
  stat_function(fun = function(x) (b[1]+b[3]) + (b[2]+b[4])*x, color = "red")+ #female line
  theme_bw()+
  labs(title = "Self-Reported High School GPA vs First Praxis Z score by Gender", 
       y = "First Attempt Praxis Z Score", x = "High School GPA", color = 'Gender')+
  scale_color_manual(name="Gender", values=c("red","blue"), labels = c('Female', 'Male'))


```

### Does *self-reported high school GPA with pell grant* predict a student's first attempt praxis performance or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

# First Praxis Z Score vs HighSchoolGPA & ReceivedPell
fpz_high_pell <- lm(first_z_score ~ HighSchoolGPA + as.factor(ReceivedPell) + HighSchoolGPA:as.factor(ReceivedPell), data = praxis_first_zscore)
summary(fpz_high_pell)
b <- coef(fpz_high_pell)
ggplot(praxis_first_zscore, aes(y = first_z_score, x = HighSchoolGPA, color = as.factor(ReceivedPell)))+
  geom_point(alpha = 0.2)+
  stat_function(fun = function(x) b[1] + b[2]*x, color = "blue")+ #pell line
  stat_function(fun = function(x) (b[1]+b[3]) + (b[2]+b[4])*x, color = "red")+ #non-pell line
  theme_bw()+
  labs(title = "Self-Reported High School GPA vs First Praxis Z score with Pell Grant", 
       y = "First Attempt Praxis Z Score", x = "High School GPA", color = 'Pell Grant')+
  scale_color_manual(name="Pell Grant", values=c("red","blue"), labels = c('Non-Pell Grant Receiver', 'Pell Grant Receiver'))


```

### Does *self-reported high school GPA with mission* predict a student's first attempt praxis performance or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

# First Praxis Z Score vs HighSchoolGPA & ServedMission
fpz_high_mission <- lm(first_z_score ~ HighSchoolGPA + as.factor(ServedMission) + HighSchoolGPA:as.factor(ServedMission), data = praxis_first_zscore)
summary(fpz_high_mission)
b <- coef(fpz_high_mission)
ggplot(praxis_first_zscore, aes(y = first_z_score, x = HighSchoolGPA, color = as.factor(ServedMission)))+
  geom_point(alpha = 0.2)+
  stat_function(fun = function(x) b[1] + b[2]*x, color = "blue")+ #non-returned missionary line
  stat_function(fun = function(x) (b[1]+b[3]) + (b[2]+b[4])*x, color = "red")+ #returned missionary line
  theme_bw()+
  labs(title = "Self-Reported High School GPA vs First Praxis Z score with Mission", 
       y = "First Attempt Praxis Z Score", x = "High School GPA", color = 'Mission')+
  scale_color_manual(name="Mission", values=c("red","blue"), labels = c('Rerturned Missionary', 'Non-Returned Missionary'))


```


* Regression 3: Target is a student's last attempt praxis z score


### Does *current cumulative college GPA* predict a student's last attempt praxis performance or not? 

```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"
praxis_last_zscore <- praxis %>% 
  select(student_id, last_z_score) %>% 
  mutate(student_id = as.character(student_id))

praxis_last_zscore <- inner_join(praxis_last_zscore, demo, by = c("student_id" = "StudentID")) %>% 
  relocate(last_z_score, .before = "student_id") %>% unique()

# Last Praxis Z Score vs CurrentCumGPA
lpz_ccgpa <- lm(last_z_score ~ CurrentCumGPA, data = praxis_last_zscore)
summary(lpz_ccgpa)
ggplot(praxis_first_zscore, aes(x = CurrentCumGPA, y = first_z_score))+
  geom_point()+
  geom_smooth(method = "lm", formula = y~x, se = FALSE)+
  theme_bw()+
  labs(title = "Current Cumulative GPA vs Last Praxis Attempt Z Score", 
       y = "Last Attempt Praxis", x = "Current Cumulative GPA")

```

### Does *current cumulative college GPA by Ethnicity* predict a student's last attempt praxis performance or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

```

### Does *current cumulative college GPA by gender* predict a student's last attempt praxis performance or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"
# Last Praxis Z Score vs CurrentCumGPA & isMale
lpz_ccgpa_gender <- lm(last_z_score ~ CurrentCumGPA + as.factor(isMale) + CurrentCumGPA:as.factor(isMale), data = praxis_last_zscore)
summary(lpz_ccgpa_gender)
b <- coef(lpz_ccgpa_gender)
ggplot(praxis_last_zscore, aes(y = last_z_score, x = CurrentCumGPA, color = as.factor(isMale)))+
  geom_point(alpha = 0.2)+
  stat_function(fun = function(x) b[1] + b[2]*x, color = "blue")+ #male line
  stat_function(fun = function(x) (b[1]+b[3]) + (b[2]+b[4])*x, color = "red" )+ #female line
  theme_bw()+
  labs(title = "Current Cummulative GPA vs Last Praxis Z score By Gender", 
       y = "Last Attempt Praxis Z Score", x = "Current Cummulative GPA", color = 'Gender')+
  scale_color_manual(name="Gender", values=c("red","blue"), labels = c('Female', 'Male'))

```

### Does *current cumulative college GPA with pell grant* predict a student's last attempt praxis performance or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"
# Last Praxis Z Score vs CurrentCumGPA & ReceivedPell
lpz_ccgpa_pell <- lm(last_z_score ~ CurrentCumGPA + as.factor(ReceivedPell) + CurrentCumGPA:as.factor(ReceivedPell), data = praxis_last_zscore)
summary(lpz_ccgpa_pell)
b <- coef(lpz_ccgpa_pell)
ggplot(praxis_last_zscore, aes(y = last_z_score, x = CurrentCumGPA, color = as.factor(ReceivedPell)))+
  geom_point(alpha = 0.2)+
  stat_function(fun = function(x) b[1] + b[2]*x, color = "blue")+ #pell line
  stat_function(fun = function(x) (b[1]+b[3]) + (b[2]+b[4])*x, color = "red" )+ #non-pell line
  theme_bw()+
  labs(title = "Current Cummulative GPA vs Last Praxis Z score with Pell Grant", 
       y = "Last Attempt Praxis Z Score", x = "Current Cummulative GPA", color = 'Pell Grant')+
  scale_color_manual(name="Pell Grant", values=c("red","blue"), labels = c('Non-Pell Grant Receiver', 'Pell Grant Receiver'))

```

### Does *current cumulative college GPA with mission* predict a student's last attempt praxis performance or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

# Last Praxis Z Score vs CurrentCumGPA & ServedMission
lpz_ccgpa_mission <- lm(last_z_score ~ CurrentCumGPA + ServedMission + CurrentCumGPA:ServedMission, data = praxis_last_zscore)
summary(lpz_ccgpa_mission)
b <- coef(lpz_ccgpa_mission)
ggplot(praxis_last_zscore, aes(y = last_z_score, x = CurrentCumGPA, color = ServedMission))+
  geom_point(alpha = 0.2)+
  stat_function(fun = function(x) b[1] + b[2]*x, color = "blue")+ #non-return missionary line
  stat_function(fun = function(x) (b[1]+b[3]) + (b[2]+b[4])*x, color = "red" )+ #returned missionary line
  theme_bw()+
  labs(title = "Current Cummulative GPA vs Last Praxis Z score with Mission", 
       y = "Last Attempt Praxis Z Score", x = "Current Cummulative GPA", color = 'Mission')+
  scale_color_manual(name="Mission", values=c("red","blue"), labels = c('Returned Missionary', 'Non-Returned Missionary'))


```

### Does *self-reported ACT and SAT score* predict a student's last attempt praxis performance or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

# Last Praxis Z Score vs ACTSAT_Score
lpz_act <- lm(last_z_score ~ ACTSAT_Scores, data = praxis_last_zscore)
summary(lpz_act)
ggplot(praxis_last_zscore, aes(y = last_z_score, x = ACTSAT_Scores))+
  geom_point(alpha = 0.2)+
  geom_smooth(method = "lm", formula = y~x, se = FALSE)+
  theme_bw()+
  labs(title = "Self-Reported ACT & SAT Score vs Last Praxis Z score", 
       y = "Last Attempt Praxis Z Score", x = "ACT & SAT Score")

```

### Does *self-reported ACT and SAT score by enthnicity* predict a student's last attempt praxis performance or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

# Last Praxis Z Score vs ACTSAT_Score & Ethnicity

```

### Does *self-reported ACT and SAT score by gender* predict a student's last attempt praxis performance or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

# Last Praxis Z Score vs ACTSAT_Score & isMale
lpz_act_gender <- lm(last_z_score ~ ACTSAT_Scores + as.factor(isMale) + ACTSAT_Scores:as.factor(isMale), data = praxis_last_zscore)
summary(lpz_act_gender)
b <- coef(fpz_act_gender)
ggplot(praxis_last_zscore, aes(y = last_z_score, x = ACTSAT_Scores, color = as.factor(isMale)))+
  geom_point(alpha = 0.2)+
  stat_function(fun = function(x) b[1] + b[2]*x, color = "blue")+ #male line
  stat_function(fun = function(x) (b[1]+b[3]) + (b[2]+b[4])*x, color = "red")+ #female line
  theme_bw()+
  labs(title = "Self-Reported ACT & SAT Score vs Last Praxis Z score by Gender", 
       y = "Last Attempt Praxis Z Score", x = "ACT & SAT Score", color = 'Gender')+
  scale_color_manual(name="Gender", values=c("red","blue"), labels = c('Female', 'Male'))
```

### Does *self-reported ACT and SAT score with pell grant* predict a student's last attempt praxis performance or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

# Last Praxis Z Score vs ACTSAT_Score & ReceivedPell
lpz_act_pell <- lm(last_z_score ~ ACTSAT_Scores + as.factor(ReceivedPell) + ACTSAT_Scores:as.factor(ReceivedPell), data = praxis_last_zscore)
summary(lpz_act_pell)
b <- coef(lpz_act_pell)
ggplot(praxis_last_zscore, aes(y = last_z_score, x = ACTSAT_Scores, color = as.factor(ReceivedPell)))+
  geom_point(alpha = 0.2)+
  stat_function(fun = function(x) b[1] + b[2]*x, color = "blue")+ #pell line
  stat_function(fun = function(x) (b[1]+b[3]) + (b[2]+b[4])*x, color = "red")+ #non-pell line
  theme_bw()+
  labs(title = "Self-Reported ACT & SAT Score vs Last Praxis Z score with Pell Grant", 
       y = "Last Attempt Praxis Z Score", x = "ACT & SAT Score", color = 'Pell Grant')+
  scale_color_manual(name="Pell Grant", values=c("red","blue"), labels = c('Non-Pell Grant Receiver', 'Pell Grant Receiver'))


```


### Does *self-reported ACT and SAT score with mission* predict a student's last attempt praxis performance or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

# Last Praxis Z Score vs ACTSAT_Score & ServedMission
lpz_act_mission <- lm(last_z_score ~ ACTSAT_Scores + as.factor(ServedMission) + ACTSAT_Scores:as.factor(ServedMission), data = praxis_last_zscore)
summary(lpz_act_mission)
b <- coef(lpz_act_mission)
ggplot(praxis_last_zscore, aes(y = last_z_score, x = ACTSAT_Scores, color = as.factor(ServedMission)))+
  geom_point(alpha = 0.2)+
  stat_function(fun = function(x) b[1] + b[2]*x, color = "blue")+ #non-returned missionary line
  stat_function(fun = function(x) (b[1]+b[3]) + (b[2]+b[4])*x, color = "red")+ #returned missionary line
  theme_bw()+
  labs(title = "Self-Reported ACT & SAT Score vs Last Praxis Z score with Mission", 
       y = "Last Attempt Praxis Z Score", x = "ACT & SAT Score", color = 'Mission')+
  scale_color_manual(name="Mission", values=c("red","blue"), labels = c('Rerturned Missionary', 'Non-Returned Missionary'))

```

### Does *self-reported high school GPA* predict a student's last attempt praxis performance or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

# Last Praxis Z Score vs HigSchoolGPA
lpz_high <- lm(last_z_score ~ HighSchoolGPA, data = praxis_last_zscore)
summary(lpz_high)
ggplot(praxis_last_zscore, aes(y = last_z_score, x = HighSchoolGPA))+
  geom_point(alpha = 0.2)+
  geom_smooth(method = "lm", formula = y~x, se = FALSE)+
  theme_bw()+
  labs(title = "Self-Reported High School GPA vs Last Praxis Z score", 
       y = "Last Attempt Praxis Z Score", x = "High School GPA")

```

### Does *self-reported high school GPA by ethnicity* predict a student's last attempt praxis performance or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

# Last Praxis Z Score vs HigSchoolGPA & Ethnicity


```

### Does *self-reported high school GPA by gender* predict a student's last attempt praxis performance or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

# Last Praxis Z Score vs HighSchoolGPA & isMale
lpz_high_gender <- lm(last_z_score ~ HighSchoolGPA + as.factor(isMale) + HighSchoolGPA:as.factor(isMale), data = praxis_last_zscore)
summary(lpz_high_gender)
b <- coef(lpz_high_gender)
ggplot(praxis_last_zscore, aes(y = last_z_score, x = HighSchoolGPA, color = as.factor(isMale)))+
  geom_point(alpha = 0.2)+
  stat_function(fun = function(x) b[1] + b[2]*x, color = "blue")+ #male line
  stat_function(fun = function(x) (b[1]+b[3]) + (b[2]+b[4])*x, color = "red")+ #female line
  theme_bw()+
  labs(title = "Self-Reported High School GPA vs Last Praxis Z score by Gender", 
       y = "Last Attempt Praxis Z Score", x = "High School GPA", color = 'Gender')+
  scale_color_manual(name="Gender", values=c("red","blue"), labels = c('Female', 'Male'))


```

### Does *self-reported high school GPA with pell grant* predict a student's last attempt praxis performance or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

# Last Praxis Z Score vs HighSchoolGPA & ReceivedPell
lpz_high_pell <- lm(last_z_score ~ HighSchoolGPA + as.factor(ReceivedPell) + HighSchoolGPA:as.factor(ReceivedPell), data = praxis_last_zscore)
summary(lpz_high_pell)
b <- coef(lpz_high_pell)
ggplot(praxis_last_zscore, aes(y = last_z_score, x = HighSchoolGPA, color = as.factor(ReceivedPell)))+
  geom_point(alpha = 0.2)+
  stat_function(fun = function(x) b[1] + b[2]*x, color = "blue")+ #pell line
  stat_function(fun = function(x) (b[1]+b[3]) + (b[2]+b[4])*x, color = "red")+ #non-pell line
  theme_bw()+
  labs(title = "Self-Reported High School GPA vs Last Praxis Z score with Pell Grant", 
       y = "Last Attempt Praxis Z Score", x = "High School GPA", color = 'Pell Grant')+
  scale_color_manual(name="Pell Grant", values=c("red","blue"), labels = c('Non-Pell Grant Receiver', 'Pell Grant Receiver'))


```

### Does *self-reported high school GPA with mission* predict a student's last attempt praxis performance or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

# Last Praxis Z Score vs HighSchoolGPA & ServedMission
lpz_high_mission <- lm(last_z_score ~ HighSchoolGPA + as.factor(ServedMission) + HighSchoolGPA:as.factor(ServedMission), data = praxis_last_zscore)
summary(lpz_high_mission)
b <- coef(lpz_high_mission)
ggplot(praxis_last_zscore, aes(y = last_z_score, x = HighSchoolGPA, color = as.factor(ServedMission)))+
  geom_point(alpha = 0.2)+
  stat_function(fun = function(x) b[1] + b[2]*x, color = "blue")+ #non-returned missionary line
  stat_function(fun = function(x) (b[1]+b[3]) + (b[2]+b[4])*x, color = "red")+ #returned missionary line
  theme_bw()+
  labs(title = "Self-Reported High School GPA vs Last Praxis Z score with Mission", 
       y = "Last Attempt Praxis Z Score", x = "High School GPA", color = 'Mission')+
  scale_color_manual(name="Mission", values=c("red","blue"), labels = c('Rerturned Missionary', 'Non-Returned Missionary'))


```

* Regression 4: Target is a student's last attempt score points from the state's passing standard

```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

praxis_last_cutoff <- praxis %>% 
  select(student_id, last_score_cutoff) %>% 
  mutate(student_id = as.character(student_id))

praxis_last_cutoff <- inner_join(praxis_last_cutoff, demo, by = c("student_id" = "StudentID")) %>% 
  relocate(last_score_cutoff, .before = "student_id") %>% unique()
```

### Does *current cumulative college GPA* predict a student's last attempt praxis points from state passing standard or not? 

```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"
# Last Attempt Score Points from State Passing Standard vs CurrentCumGPA
lc_ccgpa <- lm(last_score_cutoff ~ CurrentCumGPA, data = praxis_last_cutoff)
summary(lc_ccgpa)
ggplot(praxis_last_cutoff, aes(x = CurrentCumGPA, y = last_score_cutoff))+
  geom_point()+
  geom_smooth(method = "lm", formula = y~x, se = FALSE)+
  theme_bw()+
  labs(title = "Current Cumulative GPA vs Last Attempt Points from State Passing Standard", 
       y = "Last Attempt Points From Standard", x = "Current Cumulative GPA")

```

### Does *current cumulative college GPA by ethnicity* predict a student's last attempt praxis points from state passing standard or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

```

### Does *current cumulative college GPA by gender* predict a student's last attempt praxis points from state passing standard or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"
# Last Attempt Score Points from State Passing Standard vs CurrentCumGPA & isMale
lc_ccgpa_gender <- lm(last_score_cutoff ~ CurrentCumGPA + as.factor(isMale) + CurrentCumGPA:as.factor(isMale), data = praxis_last_cutoff)
summary(lc_ccgpa_gender)
b <- coef(lc_ccgpa_gender)
ggplot(praxis_last_cutoff, aes(y = last_score_cutoff, x = CurrentCumGPA, color = as.factor(isMale)))+
  geom_point(alpha = 0.2)+
  stat_function(fun = function(x) b[1] + b[2]*x, color = "blue")+ #male line
  stat_function(fun = function(x) (b[1]+b[3]) + (b[2]+b[4])*x, color = "red" )+ #female line
  theme_bw()+
  labs(title = "Current Cummulative GPA vs Last Attempt Points from State Passing Standard by Gender", 
       y = "Last Attempt Points From Standard", x = "Current Cummulative GPA", color = 'Gender')+
  scale_color_manual(name="Gender", values=c("red","blue"), labels = c('Female', 'Male'))

```

### Does *current cumulative college GPA with pell grant* predict a student's last attempt praxis points from state passing standard or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"
# Last Attempt Score Points from State Passing Standard vs CurrentCumGPA & ReceivedPell
lc_ccgpa_pell <- lm(last_score_cutoff ~ CurrentCumGPA + as.factor(ReceivedPell) + CurrentCumGPA:as.factor(ReceivedPell), data = praxis_last_cutoff)
summary(lc_ccgpa_pell)
b <- coef(lc_ccgpa_pell)
ggplot(praxis_last_cutoff, aes(y = last_score_cutoff, x = CurrentCumGPA, color = as.factor(ReceivedPell)))+
  geom_point(alpha = 0.2)+
  stat_function(fun = function(x) b[1] + b[2]*x, color = "blue")+ #pell line
  stat_function(fun = function(x) (b[1]+b[3]) + (b[2]+b[4])*x, color = "red" )+ #non-pell line
  theme_bw()+
  labs(title = "Current Cummulative GPA vs Last Attempt Points from State Passing Standard with Pell Grant", 
       y = "Last Attempt Points From Standard", x = "Current Cummulative GPA", color = 'Pell Grant')+
  scale_color_manual(name="Pell Grant", values=c("red","blue"), labels = c('Non-Pell Grant Receiver', 'Pell Grant Receiver'))


```

### Does *current cumulative college GPA with mission* predict a student's last attempt praxis points from state passing standard or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

# Last Attempt Score Points from State Passing Standard vs CurrentCumGPA & ServedMission
lc_ccgpa_mission <- lm(last_score_cutoff ~ CurrentCumGPA + ServedMission + CurrentCumGPA:ServedMission, data = praxis_last_cutoff)
summary(lc_ccgpa_mission)
b <- coef(lc_ccgpa_mission)
ggplot(praxis_last_cutoff, aes(y = last_score_cutoff, x = CurrentCumGPA, color = ServedMission))+
  geom_point(alpha = 0.2)+
  stat_function(fun = function(x) b[1] + b[2]*x, color = "blue")+ #non-return missionary line
  stat_function(fun = function(x) (b[1]+b[3]) + (b[2]+b[4])*x, color = "red" )+ #returned missionary line
  theme_bw()+
  labs(title = "Current Cummulative GPA vs Last Attempt Points from State Passing Standard with Mission", 
       y = "Last Attempt Points From Standard", x = "Current Cummulative GPA", color = 'Mission')+
  scale_color_manual(name="Mission", values=c("red","blue"), labels = c('Returned Missionary', 'Non-Returned Missionary'))


```

### Does *self-reported ACT and SAT score* predict a student's last attempt praxis points from state passing standard or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

# Last Attempt Score Points from State Passing Standard vs ACTSAT_Score
lc_act <- lm(last_score_cutoff ~ ACTSAT_Scores, data = praxis_last_cutoff)
summary(lc_act)
ggplot(praxis_last_cutoff, aes(y = last_score_cutoff, x = ACTSAT_Scores))+
  geom_point(alpha = 0.2)+
  geom_smooth(method = "lm", formula = y~x, se = FALSE)+
  theme_bw()+
  labs(title = "Self-Reported ACT & SAT Score vs Last Attempt Points from State Passing Standard", 
       y = "Last Attempt Points From Standard", x = "ACT & SAT Score")


```

### Does *self-reported ACT and SAT score by enthnicity* predict a student's last attempt praxis points from state passing standard or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

# Last Attempt Score Points from State Passing Standard vs ACTSAT_Score & Ethnicity

```

### Does *self-reported ACT and SAT score by gender* predict a student's last attempt praxis points from state passing standard or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

# Last Attempt Score Points from State Passing Standard vs ACTSAT_Score & isMale
lc_act_gender <- lm(last_score_cutoff ~ ACTSAT_Scores + as.factor(isMale) + ACTSAT_Scores:as.factor(isMale), data = praxis_last_cutoff)
summary(lc_act_gender)
b <- coef(lc_act_gender)
ggplot(praxis_last_cutoff, aes(y = last_score_cutoff, x = ACTSAT_Scores, color = as.factor(isMale)))+
  geom_point(alpha = 0.2)+
  stat_function(fun = function(x) b[1] + b[2]*x, color = "blue")+ #male line
  stat_function(fun = function(x) (b[1]+b[3]) + (b[2]+b[4])*x, color = "red")+ #female line
  theme_bw()+
  labs(title = "Self-Reported ACT & SAT Score vs Last Attempt Points from State Passing Standard by Gender", 
       y = "Last Attempt Points From Standard", x = "ACT & SAT Score", color = 'Gender')+
  scale_color_manual(name="Gender", values=c("red","blue"), labels = c('Female', 'Male'))
```

### Does *self-reported ACT and SAT score with pell grant* predict a student's last attempt praxis points from state passing standard or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

# Last Attempt Score Points from State Passing Standard vs ACTSAT_Score & ReceivedPell
lc_act_pell <- lm(last_score_cutoff ~ ACTSAT_Scores + as.factor(ReceivedPell) + ACTSAT_Scores:as.factor(ReceivedPell), data = praxis_last_cutoff)
summary(lc_act_pell)
b <- coef(lc_act_pell)
ggplot(praxis_last_cutoff, aes(y = last_score_cutoff, x = ACTSAT_Scores, color = as.factor(ReceivedPell)))+
  geom_point(alpha = 0.2)+
  stat_function(fun = function(x) b[1] + b[2]*x, color = "blue")+ #pell line
  stat_function(fun = function(x) (b[1]+b[3]) + (b[2]+b[4])*x, color = "red")+ #non-pell line
  theme_bw()+
  labs(title = "Self-Reported ACT & SAT Score vs Last Attempt Points from State Passing Standard with Pell Grant", 
       y = "Last Attempt Points From Standard", x = "ACT & SAT Score", color = 'Pell Grant')+
  scale_color_manual(name="Pell Grant", values=c("red","blue"), labels = c('Non-Pell Grant Receiver', 'Pell Grant Receiver'))


```


### Does *self-reported ACT and SAT score with mission* predict a student's last attempt praxis points from state passing standard or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

# Last Attempt Score Points from State Passing Standard vs ACTSAT_Score & ServedMission
lc_act_mission <- lm(last_score_cutoff~ ACTSAT_Scores + as.factor(ServedMission) + ACTSAT_Scores:as.factor(ServedMission), data = praxis_last_cutoff)
summary(lc_act_mission)
b <- coef(lc_act_mission)
ggplot(praxis_last_cutoff, aes(y = last_score_cutoff, x = ACTSAT_Scores, color = as.factor(ServedMission)))+
  geom_point(alpha = 0.2)+
  stat_function(fun = function(x) b[1] + b[2]*x, color = "blue")+ #non-returned missionary line
  stat_function(fun = function(x) (b[1]+b[3]) + (b[2]+b[4])*x, color = "red")+ #returned missionary line
  theme_bw()+
  labs(title = "Self-Reported ACT & SAT Score vs Last Attempt Points from State Passing Standard with Mission", 
       y = "Last Attempt Points From Standard", x = "ACT & SAT Score", color = 'Mission')+
  scale_color_manual(name="Mission", values=c("red","blue"), labels = c('Rerturned Missionary', 'Non-Returned Missionary'))

```




### Does *self-reported high school GPA* predict a student's last attempt praxis points from state passing standard or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

# Last Attempt Score Points from State Passing Standard vs HigSchoolGPA
lc_high <- lm(last_score_cutoff ~ HighSchoolGPA, data = praxis_last_cutoff)
summary(lc_high)
ggplot(praxis_last_cutoff, aes(y = last_score_cutoff, x = HighSchoolGPA))+
  geom_point(alpha = 0.2)+
  geom_smooth(method = "lm", formula = y~x, se = FALSE)+
  theme_bw()+
  labs(title = "Self-Reported High School GPA vs Last Attempt Points from State Passing Standard", 
       y = "Last Attempt Points From Standard", x = "High School GPA")

```

### Does *self-reported high school GPA by ethnicity* predict a student's last attempt praxis points from state passing standard or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

# Last Attempt Score Points from State Passing Standard vs HigSchoolGPA & Ethnicity


```

### Does *self-reported high school GPA by gender* predict a student's last attempt praxis points from state passing standard or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

# Last Attempt Score Points from State Passing Standard vs HighSchoolGPA & isMale
lc_high_gender <- lm(last_score_cutoff ~ HighSchoolGPA + as.factor(isMale) + HighSchoolGPA:as.factor(isMale), data = praxis_last_cutoff)
summary(lc_high_gender)
b <- coef(lc_high_gender)
ggplot(praxis_last_cutoff, aes(y = last_score_cutoff, x = HighSchoolGPA, color = as.factor(isMale)))+
  geom_point(alpha = 0.2)+
  stat_function(fun = function(x) b[1] + b[2]*x, color = "blue")+ #male line
  stat_function(fun = function(x) (b[1]+b[3]) + (b[2]+b[4])*x, color = "red")+ #female line
  theme_bw()+
  labs(title = "Self-Reported High School GPA vs Last Attempt Points from State Passing Standard by Gender", 
       y = "Last Attempt Points From Standard", x = "High School GPA", color = 'Gender')+
  scale_color_manual(name="Gender", values=c("red","blue"), labels = c('Female', 'Male'))


```

### Does *self-reported high school GPA with pell grant* predict a student's last attempt praxis points from state passing standard or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

# Last Attempt Score Points from State Passing Standard vs HighSchoolGPA & ReceivedPell
lc_high_pell <- lm(last_score_cutoff ~ HighSchoolGPA + as.factor(ReceivedPell) + HighSchoolGPA:as.factor(ReceivedPell), data = praxis_last_cutoff)
summary(lc_high_pell)
b <- coef(lc_high_pell)
ggplot(praxis_last_cutoff, aes(y = last_score_cutoff, x = HighSchoolGPA, color = as.factor(ReceivedPell)))+
  geom_point(alpha = 0.2)+
  stat_function(fun = function(x) b[1] + b[2]*x, color = "blue")+ #pell line
  stat_function(fun = function(x) (b[1]+b[3]) + (b[2]+b[4])*x, color = "red")+ #non-pell line
  theme_bw()+
  labs(title = "Self-Reported High School GPA vs Last Attempt Points from State Passing Standard with Pell Grant", 
       y = "Last Attempt Points From Standard", x = "High School GPA", color = 'Pell Grant')+
  scale_color_manual(name="Pell Grant", values=c("red","blue"), labels = c('Non-Pell Grant Receiver', 'Pell Grant Receiver'))


```

### Does *self-reported high school GPA with mission* predict a student's last attempt praxis points from state passing standard or not? 
```{r, message = FALSE, warning = FALSE}
#| echo: true
#| code-fold: true
#| #| code-summary: "expand for full code"

# Last Attempt Score Points from State Passing Standard vs HighSchoolGPA & ServedMission
lc_high_mission <- lm(last_score_cutoff ~ HighSchoolGPA + as.factor(ServedMission) + HighSchoolGPA:as.factor(ServedMission), data = praxis_last_cutoff)
summary(lc_high_mission)
b <- coef(lc_high_mission)
ggplot(praxis_last_cutoff, aes(y = last_score_cutoff, x = HighSchoolGPA, color = as.factor(ServedMission)))+
  geom_point(alpha = 0.2)+
  stat_function(fun = function(x) b[1] + b[2]*x, color = "blue")+ #non-returned missionary line
  stat_function(fun = function(x) (b[1]+b[3]) + (b[2]+b[4])*x, color = "red")+ #returned missionary line
  theme_bw()+
  labs(title = "Self-Reported High School GPA vs Last Attempt Points from State Passing Standard with Mission", 
       y = "Last Attempt Points From Standard", x = "High School GPA", color = 'Mission')+
  scale_color_manual(name="Mission", values=c("red","blue"), labels = c('Rerturned Missionary', 'Non-Returned Missionary'))

```